{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://mirprotocol.net/schema/claim.schema.json",
  "title": "MIR Claim",
  "description": "A structured, verifiable claim anchored to domain authority and time.",
  "type": "object",
  "required": ["version", "type", "domain", "subject", "timestamp"],
  "additionalProperties": false,
  "properties": {
    "version": {
      "type": "integer",
      "const": 1,
      "description": "Protocol version. Currently 1."
    },
    "type": {
      "type": "string",
      "description": "Claim type from the MIR type registry.",
      "enum": [
        "transaction.initiated",
        "transaction.completed",
        "transaction.fulfilled",
        "transaction.cancelled",
        "transaction.refunded",
        "transaction.disputed",
        "transaction.chargeback",
        "account.created",
        "account.updated",
        "account.verified",
        "account.suspended",
        "account.closed",
        "review.submitted",
        "review.received",
        "rating.received",
        "message.sent",
        "message.received",
        "response.provided",
        "policy.warning",
        "policy.violation",
        "terms.violation",
        "signal.positive",
        "signal.negative"
      ]
    },
    "domain": {
      "type": "string",
      "description": "Verified domain of the submitting partner.",
      "pattern": "^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\\.)+[a-zA-Z]{2,}$"
    },
    "subject": {
      "type": "string",
      "description": "SHA-256 hash of the user identifier (hex-encoded, lowercase).",
      "pattern": "^[a-f0-9]{64}$"
    },
    "timestamp": {
      "type": "string",
      "description": "ISO 8601 datetime of when the event occurred.",
      "format": "date-time"
    },
    "metadata": {
      "type": "object",
      "description": "Type-specific structured context. Maximum 4 KB serialized. Must not contain PII.",
      "additionalProperties": true
    }
  }
}
